---++ Disguises based on MGeneric UrHuman

---+++ Overview

With the advent of UrHuman details all utilising makebodypartdesc to
generate the brief, look and examine for each detail, disguises become
fully functional as makebodypartdesc (found on MGeneric:UrAvatar) makes
use of disguise:\* properties, if available to generate detail
descriptions. Disguises have now progressed from the single disguise
cloak to items inherited from UrDisguise which encapsulates the central
react-post:wear and react-post:unwear code.

With this new system you can now easily define disguise descriptions for
any detail as well as set precedence scores for these details so that
you can fine tune which details are overridden when multiple disguises
are worn. The rest of this document describes the properties used to
define a disguise as well as the properties generated by the disguise
system when in use.

---+++ Disguise definition properties These are the properties that
define a disguise item

    * *disguise:default:adjectives*
        * type        : string array
        * description : this array holds the list of adjectives that will be added to the default details adjective list when the disguise is worn.

    * *disguise:superbrief*
        * type        : SAM string
        * description : this string overrides the trait:superbrief property on the

player, thereby affecting their brief description.

    * *disguise:override:look*
        * type        : SAM string
        * description : this string replaces the players look for the default detail. Note that wounds, bruises, scars and tattoo descriptions may still be added to this description depending on the disguise properties used.

    * *disguise:override:examine*
        * type        : SAM string
        * description : the replacement for the players examine. If this is not present the override for the look is used instead.


    * *disguise:title*
        * type        : SAM string
        * description : this string overrides the trait:title for the player


    * *disguise:descriptions*
        * type        : mapping ([string:({string array})])
        * description : this mapping matches detail names to the disguise brief,look and examine descriptions. i.e. (["detailname":({"brief","look","examine"})]). The look description is used if the examine is not present.

    * *disguise:details:adjectives*
        * type        : mapping ([string:({string array})])
        * description : like the descriptions mapping this mapping associates adjectives for a detail with the detail name e.g. (["face":({"shadowy","concealed"})])


    * *disguise:wearpriority*
        * type        : mapping ([string:int])
        * description : this mapping associates a precedence level with a detail for this disguise. The higher the number the more likely it is that it will override the detail description of a disguise that is worn in conjunction with this one. For example...my mask covers the face detail and has disguise:wearpriority=(["face":10]), my cloak also covers the face detail and has disguise:wearpriority = (["face":1]). When worn together the mask descriptions (defined in disguise:descriptions) will always be used instead of the cloak descriptions as it has a higer priority score for the face detail.


    * *disguise:hidedetails*
        * type        : mapping ([string:({string array})])
        * description : this mapping associates details that may be shown as a consequence of wearing a disguise with details that would therefore require hiding. For example....my character is bald, therefore the hair detail is not displayed, however I wear a mask with pink hair. Upon wearing the mask the hair detail must be unhidden, hair is then crossreferenced in this mapping to see if any details require hiding as a consequence of showing the hair detail.



    * *disguise:hides-bruise, disguise:hides-scar, disguise:hides-tattoo, disguise:hides-wound*
        * type       : int
        * description : these flags determine whether bruises, scars, tattoos and wounds are hidden when the disguise is worn.

---+++ Disguise system properties

These properties are created on the disguised player when they are
wearing a disguise

    * *disguise:descriptions*
        * type       : mapping ([string:({string array})])
        * description : taken from the worn disguises this mapping holds the current brief, look and examines for the disguised details. It is used by makebodypartdesc and is updated when a disguise is removed or another one is worn.

    * *disguise:details:adjectives*
        * type       : mapping ([string:({string array})])
        * description : maps detail names to adjectives that have been added to that detail from the disguise

    * *disguise:disguises*
        * type       : object array
        * description : and array of the current disguise objects being worn

    * *disguise:override:brief, disguise:override:superbrief, disguise:override:look, disguise:override:examine, disguise:override:title*
        * type       : string(s)
        * description : these properties hold the values from the player so that they may be restored when all disguises are removed



    * *disguise:unwearhidedetails*
        * type       : mapping ([string:int])
        * description : this mapping holds the names of the details that require hidding again when disguises are removed. A count is held against each detail and upon removal, each disguises that would have show this detail decreases the count. At zero the detail his hidden.

    * *disguise:unwearshowdetails*
        * type       : mapping ([string:int])
        * description : the opposite of the above mapping ensures that details that have been hidden are reshown when disguises are removed.

    * *disguise:wearpriority*
        * type       : mapping ([string:int])
        * description : this is the current list of priority scors for the combination of worn disguises. When a new disguise is worn it is this list that the disguises details priority scores are checked against.

---+++ Making a disguise example

Let's now look at the properties used to define a disguise mask:

First of all lets define the properties of the mask that alter the
default detail of the wearer

`<verbatim>`{=html}
`<Core:Property property="export:disguise:superbrief">`{=html} X\[S\] a
masked \$(this.trait:sex) `</Core:Property>`{=html}

`<Core:Property property="export:disguise:override:examine">`{=html}
X\[S\] \<describe what="\$(this)"/\> with a head of bright pink hair.
`</Core:Property>`{=html}

`<Core:Property property="export:disguise:override:look">`{=html} X\[S\]
\<describe what="\$(this)"/\> with a head of bright pink hair.
`</Core:Property>`{=html}

`<Core:Property property="export:disguise:title">`{=html} "none"
`</Core:Property>`{=html}

`<Core:Property property="export:disguise:default:adjectives">`{=html}
({ "masked" }) `</Core:Property>`{=html}

`</verbatim>`{=html}

Next let us define the descriptions for the details that are covered by
the mask:

`<verbatim>`{=html}
`<Core:Property property="export:disguise:descriptions">`{=html} (\[
"brow":({ "masked brow", "A masked forehead" }), "cheeks":({ "masked
cheeks", "A pair of cheeks, hidden from view by a mask" }),
"chin":({"masked chin", \" a chin, hidden from view by a mask\" }),
"earlobes":({ "pair of masked earlobes", "a pair of earlobes, hidden
from view by a mask" }), "ears":({ "pair of masked ears", "a pair of
ears, hidden from view by a mask"}), "eyebrow":({ "masked eyebrow", "an
eyebrow, hidden from view by a mask"}), "eyebrows":({ "pair of masked
eyebrows", "a pair of eyebrows, hidden from view by a mask" }),
"eyes":({ "pair of masked eyes", "a pair of eyes, hidden from view by a
mask" }), "face":({ "masked face", "a masked face, hidden from view by a
mask" }), "hair":({ "pink hair", "a head of bright pink hair" }),
"jaw":({ "masked jaw", "a jaw, hidden from view by a mask" }),\
"leftcheek":({"masked cheek", "a cheek, hidden from view by a mask" }),
"leftear":({ "masked ear", "an ear, hidden from view by a mask" }),
"leftearlobe":({ "masked earlobe", "an earlobe, hidden from view by a
mask" }), "lefteye":({ "hidden eye", "a shrouded eye, hidden from view
by a mask" }), "lip":({ "masked lip","a lip, hidden from view by a mask"
}),\
"liplower":({ "masked lower lip", \" a lower lip, hidden from view by a
mask\" }), "lipupper":({ "masked upper lip","an upper lip, hidden from
view by a mask" }), "lips":({ "pair of mask lips","a pair of lips,
hidden from view by a mask" }), "mouth":({ "masked mouth", "a mouth,
hidden from view by a mask" }), "nose":({ "masked nose", "a nose,hidden
from view by a mask" }),\
"rightcheek":({ "masked cheek", "a cheek, hidden from view by a mask"
}), "rightear":({ "masked ear", "an ear, hidden from view by a mask" }),
"rightearlobe":({ "masked earlobe", "an earlobe, hidden from view by a
mask" }), "righteye":({ "masked eye", "a shrouded eye, hidden from view
by a mask" }) \]) `</Core:Property>`{=html}

`<Core:Property property="export:disguise:wearpriority">`{=html} (\[
"brow":10, "cheeks":10, "chin":10, "earlobes":10, "ears":10,
"eyebrow":10, "eyebrows":10, "eyes":10, "face":10, "hair":10,
"jaw":10,"leftcheek":10, "leftear":10, "leftearlobe":10, "lefteye":10,
"lip":10, "liplower":10, "lipupper":10, "lips":10, "mouth":10,
"nose":10, "rightcheek":10,"rightear":10, "rightearlobe":10,
"righteye":10 \]) `</Core:Property>`{=html}

`</verbatim>`{=html}

and finally some adjectives to match to the disguised details and the
information that the "pate" details should be hidden if this disguise
un-hides the hair detail

`<verbatim>`{=html}
`<Core:Property property="export:disguise:details:adjectives">`{=html}
(\[ "face":({ "deformed" }) \]) `</Core:Property>`{=html}

`<Core:Property property="export:disguise:hidedetails">`{=html} (\[
"hair":({ "pate" }) \]) `</Core:Property>`{=html} `</verbatim>`{=html}

-- Main.CarlGriffiths - 21 Oct 2004
